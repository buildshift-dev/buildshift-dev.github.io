
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Full Stack Developer specializing in AWS Serverless, Python, and modern development workflows">
      
      
        <meta name="author" content="buildshift.dev">
      
      
        <link rel="canonical" href="https://buildshift.dev/blog/category/devops/">
      
      
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../assets/images/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>DevOps - buildshift.dev</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/css/buildshift.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-4SV8ZKYLT1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-4SV8ZKYLT1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-4SV8ZKYLT1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  <!-- Font Awesome for icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <!-- Fixed banner styling -->
  <style>
    body { padding-top: 40px !important; }
    .md-header { top: 40px !important; }
    .md-tabs { top: 40px !important; }
  </style>

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#devops" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
  <!-- Under Construction Announcement -->
  <div style="background: #000000; text-align: center; padding: 8px 0; position: fixed; top: 0; left: 0; right: 0; z-index: 9999; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);">
    <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; font-size: 14px; font-weight: 500; color: #ffa500;">
      <i class="fas fa-hard-hat"></i>
      <span>...Under Construction...</span>
    </div>
  </div>

          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="buildshift.dev" class="md-header__button md-logo" aria-label="buildshift.dev" data-md-component="logo">
      
  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            buildshift.dev
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DevOps
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/buildshift-dev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    buildshift-dev
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link">
        
  
  
    
  
  buildshift.dev Blog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="buildshift.dev" class="md-nav__button md-logo" aria-label="buildshift.dev" data-md-component="logo">
      
  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==" alt="logo">

    </a>
    buildshift.dev
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/buildshift-dev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    buildshift-dev
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    buildshift.dev Blog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="devops">DevOps</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/buildshift-dev.png" alt="BuildShift Developer">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-06-30 20:15:00-04:00">Jun 30, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../code-quality/" class="md-meta__link">Code Quality</a>, 
              <a href="../python/" class="md-meta__link">Python</a>, 
              <a href="./" class="md-meta__link">DevOps</a></li>
        
        
          
          <li class="md-meta__item">
            
              10 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="code-quality-automation-pre-commit-hooks-and-cicd"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/">Code Quality Automation: Pre-commit Hooks and CI/CD</a></h2>
<p>Code quality isn't about perfection—it's about consistency. I've worked on teams where every developer had their own formatting style, their own import organization, their own naming conventions. Code reviews devolved into style debates instead of logic discussions. Time was wasted on manual formatting instead of solving problems.</p>
<p>The <a href="https://github.com/buildshift-dev/clean-py">clean-py repository</a> demonstrates how automation eliminates these issues entirely. Quality checks run automatically. Formatting happens without thinking. Security scans catch vulnerabilities before they reach production. This isn't about replacing human judgment—it's about freeing humans to focus on what matters.</p>
<h3 id="the-cost-of-manual-quality-control"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#the-cost-of-manual-quality-control">The Cost of Manual Quality Control</a></h3>
<p>Let me paint a familiar picture. A developer submits a pull request. The reviewer spots inconsistent formatting. "Please run Black," they comment. The developer formats the code, pushes again. Now there's a linting error. Another round trip. Then someone notices the imports aren't sorted. Another push. Finally, the actual logic review begins—but everyone's already frustrated.</p>
<p>I've seen this pattern waste days per sprint. Worse, when developers are tired or rushed, quality checks get skipped. "We'll fix it later," becomes technical debt that never gets paid.</p>
<p>Manual quality control has hidden costs:
- <strong>Context switching</strong>: Developers break flow to run quality tools
- <strong>Inconsistent application</strong>: Some files get checked, others don't
- <strong>Review fatigue</strong>: Reviewers waste energy on mechanical issues
- <strong>Delayed feedback</strong>: Problems found late in the process are expensive to fix
- <strong>Knowledge silos</strong>: Only certain developers know all the quality rules</p>
<h3 id="pre-commit-hooks-your-first-line-of-defense"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#pre-commit-hooks-your-first-line-of-defense">Pre-commit Hooks: Your First Line of Defense</a></h3>
<p>Pre-commit hooks solve these problems by running quality checks automatically before code enters the repository. The <a href="https://github.com/buildshift-dev/clean-py">clean-py repository</a> uses a comprehensive pre-commit configuration:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c1"># .pre-commit-config.yaml</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="nt">default_language_version</span><span class="p">:</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="w">  </span><span class="nt">python</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3.11</span>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="nt">repos</span><span class="p">:</span>
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a><span class="w">  </span><span class="c1"># General file fixes</span>
<a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/pre-commit/pre-commit-hooks</span>
<a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v4.5.0</span>
<a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trailing-whitespace</span>
<a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">end-of-file-fixer</span>
<a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-yaml</span>
<a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;--unsafe&#39;</span><span class="p p-Indicator">]</span><span class="w">  </span><span class="c1"># Allow custom tags</span>
<a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-json</span>
<a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-toml</span>
<a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-added-large-files</span>
<a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;--maxkb=1000&#39;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-case-conflict</span>
<a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check-merge-conflict</span>
<a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">detect-private-key</span>
<a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">debug-statements</span>
<a id="__codelineno-48-22" name="__codelineno-48-22" href="#__codelineno-48-22"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mixed-line-ending</span>
<a id="__codelineno-48-23" name="__codelineno-48-23" href="#__codelineno-48-23"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;--fix=lf&#39;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-24" name="__codelineno-48-24" href="#__codelineno-48-24"></a>
<a id="__codelineno-48-25" name="__codelineno-48-25" href="#__codelineno-48-25"></a><span class="w">  </span><span class="c1"># Python code formatting</span>
<a id="__codelineno-48-26" name="__codelineno-48-26" href="#__codelineno-48-26"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/psf/black</span>
<a id="__codelineno-48-27" name="__codelineno-48-27" href="#__codelineno-48-27"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">23.11.0</span>
<a id="__codelineno-48-28" name="__codelineno-48-28" href="#__codelineno-48-28"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-29" name="__codelineno-48-29" href="#__codelineno-48-29"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black</span>
<a id="__codelineno-48-30" name="__codelineno-48-30" href="#__codelineno-48-30"></a><span class="w">        </span><span class="nt">language_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3.11</span>
<a id="__codelineno-48-31" name="__codelineno-48-31" href="#__codelineno-48-31"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;--line-length=88&#39;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-32" name="__codelineno-48-32" href="#__codelineno-48-32"></a>
<a id="__codelineno-48-33" name="__codelineno-48-33" href="#__codelineno-48-33"></a><span class="w">  </span><span class="c1"># Python import sorting</span>
<a id="__codelineno-48-34" name="__codelineno-48-34" href="#__codelineno-48-34"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/pycqa/isort</span>
<a id="__codelineno-48-35" name="__codelineno-48-35" href="#__codelineno-48-35"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5.12.0</span>
<a id="__codelineno-48-36" name="__codelineno-48-36" href="#__codelineno-48-36"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-37" name="__codelineno-48-37" href="#__codelineno-48-37"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">isort</span>
<a id="__codelineno-48-38" name="__codelineno-48-38" href="#__codelineno-48-38"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;--profile&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;--line-length&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;88&quot;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-39" name="__codelineno-48-39" href="#__codelineno-48-39"></a>
<a id="__codelineno-48-40" name="__codelineno-48-40" href="#__codelineno-48-40"></a><span class="w">  </span><span class="c1"># Python linting with Ruff (fast!)</span>
<a id="__codelineno-48-41" name="__codelineno-48-41" href="#__codelineno-48-41"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/charliermarsh/ruff-pre-commit</span>
<a id="__codelineno-48-42" name="__codelineno-48-42" href="#__codelineno-48-42"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v0.1.6</span>
<a id="__codelineno-48-43" name="__codelineno-48-43" href="#__codelineno-48-43"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-44" name="__codelineno-48-44" href="#__codelineno-48-44"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ruff</span>
<a id="__codelineno-48-45" name="__codelineno-48-45" href="#__codelineno-48-45"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">--fix</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--exit-non-zero-on-fix</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-46" name="__codelineno-48-46" href="#__codelineno-48-46"></a>
<a id="__codelineno-48-47" name="__codelineno-48-47" href="#__codelineno-48-47"></a><span class="w">  </span><span class="c1"># Security scanning</span>
<a id="__codelineno-48-48" name="__codelineno-48-48" href="#__codelineno-48-48"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/PyCQA/bandit</span>
<a id="__codelineno-48-49" name="__codelineno-48-49" href="#__codelineno-48-49"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.7.5</span>
<a id="__codelineno-48-50" name="__codelineno-48-50" href="#__codelineno-48-50"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-51" name="__codelineno-48-51" href="#__codelineno-48-51"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit</span>
<a id="__codelineno-48-52" name="__codelineno-48-52" href="#__codelineno-48-52"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;-r&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;src&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;-ll&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;--skip&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;B101&#39;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-53" name="__codelineno-48-53" href="#__codelineno-48-53"></a><span class="w">        </span><span class="nt">exclude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/</span>
<a id="__codelineno-48-54" name="__codelineno-48-54" href="#__codelineno-48-54"></a>
<a id="__codelineno-48-55" name="__codelineno-48-55" href="#__codelineno-48-55"></a><span class="w">  </span><span class="c1"># Type checking</span>
<a id="__codelineno-48-56" name="__codelineno-48-56" href="#__codelineno-48-56"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/pre-commit/mirrors-mypy</span>
<a id="__codelineno-48-57" name="__codelineno-48-57" href="#__codelineno-48-57"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.7.1</span>
<a id="__codelineno-48-58" name="__codelineno-48-58" href="#__codelineno-48-58"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-59" name="__codelineno-48-59" href="#__codelineno-48-59"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mypy</span>
<a id="__codelineno-48-60" name="__codelineno-48-60" href="#__codelineno-48-60"></a><span class="w">        </span><span class="nt">additional_dependencies</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<a id="__codelineno-48-61" name="__codelineno-48-61" href="#__codelineno-48-61"></a><span class="w">          </span><span class="nv">types-requests</span><span class="p p-Indicator">,</span>
<a id="__codelineno-48-62" name="__codelineno-48-62" href="#__codelineno-48-62"></a><span class="w">          </span><span class="nv">types-redis</span><span class="p p-Indicator">,</span>
<a id="__codelineno-48-63" name="__codelineno-48-63" href="#__codelineno-48-63"></a><span class="w">          </span><span class="nv">types-python-jose</span><span class="p p-Indicator">,</span>
<a id="__codelineno-48-64" name="__codelineno-48-64" href="#__codelineno-48-64"></a><span class="w">          </span><span class="nv">types-passlib</span>
<a id="__codelineno-48-65" name="__codelineno-48-65" href="#__codelineno-48-65"></a><span class="w">        </span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-66" name="__codelineno-48-66" href="#__codelineno-48-66"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">--strict</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--ignore-missing-imports</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-67" name="__codelineno-48-67" href="#__codelineno-48-67"></a><span class="w">        </span><span class="nt">exclude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tests/</span>
<a id="__codelineno-48-68" name="__codelineno-48-68" href="#__codelineno-48-68"></a>
<a id="__codelineno-48-69" name="__codelineno-48-69" href="#__codelineno-48-69"></a><span class="w">  </span><span class="c1"># Upgrade Python syntax</span>
<a id="__codelineno-48-70" name="__codelineno-48-70" href="#__codelineno-48-70"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/asottile/pyupgrade</span>
<a id="__codelineno-48-71" name="__codelineno-48-71" href="#__codelineno-48-71"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v3.15.0</span>
<a id="__codelineno-48-72" name="__codelineno-48-72" href="#__codelineno-48-72"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-73" name="__codelineno-48-73" href="#__codelineno-48-73"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pyupgrade</span>
<a id="__codelineno-48-74" name="__codelineno-48-74" href="#__codelineno-48-74"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">--py311-plus</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-75" name="__codelineno-48-75" href="#__codelineno-48-75"></a>
<a id="__codelineno-48-76" name="__codelineno-48-76" href="#__codelineno-48-76"></a><span class="w">  </span><span class="c1"># Check for common security issues</span>
<a id="__codelineno-48-77" name="__codelineno-48-77" href="#__codelineno-48-77"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://github.com/Lucas-C/pre-commit-hooks-safety</span>
<a id="__codelineno-48-78" name="__codelineno-48-78" href="#__codelineno-48-78"></a><span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1.3.2</span>
<a id="__codelineno-48-79" name="__codelineno-48-79" href="#__codelineno-48-79"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-80" name="__codelineno-48-80" href="#__codelineno-48-80"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-safety-dependencies-check</span>
<a id="__codelineno-48-81" name="__codelineno-48-81" href="#__codelineno-48-81"></a><span class="w">        </span><span class="nt">files</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pyproject.toml</span>
<a id="__codelineno-48-82" name="__codelineno-48-82" href="#__codelineno-48-82"></a>
<a id="__codelineno-48-83" name="__codelineno-48-83" href="#__codelineno-48-83"></a><span class="w">  </span><span class="c1"># Custom local hooks</span>
<a id="__codelineno-48-84" name="__codelineno-48-84" href="#__codelineno-48-84"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local</span>
<a id="__codelineno-48-85" name="__codelineno-48-85" href="#__codelineno-48-85"></a><span class="w">    </span><span class="nt">hooks</span><span class="p">:</span>
<a id="__codelineno-48-86" name="__codelineno-48-86" href="#__codelineno-48-86"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-print-statements</span>
<a id="__codelineno-48-87" name="__codelineno-48-87" href="#__codelineno-48-87"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check for print statements</span>
<a id="__codelineno-48-88" name="__codelineno-48-88" href="#__codelineno-48-88"></a><span class="w">        </span><span class="nt">entry</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;(?&lt;!def</span><span class="nv"> </span><span class="s">)print\(&#39;</span>
<a id="__codelineno-48-89" name="__codelineno-48-89" href="#__codelineno-48-89"></a><span class="w">        </span><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pygrep</span>
<a id="__codelineno-48-90" name="__codelineno-48-90" href="#__codelineno-48-90"></a><span class="w">        </span><span class="nt">types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-91" name="__codelineno-48-91" href="#__codelineno-48-91"></a><span class="w">        </span><span class="nt">exclude</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(scripts/|examples/)</span>
<a id="__codelineno-48-92" name="__codelineno-48-92" href="#__codelineno-48-92"></a>
<a id="__codelineno-48-93" name="__codelineno-48-93" href="#__codelineno-48-93"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-fixme-comments</span>
<a id="__codelineno-48-94" name="__codelineno-48-94" href="#__codelineno-48-94"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check for FIXME comments</span>
<a id="__codelineno-48-95" name="__codelineno-48-95" href="#__codelineno-48-95"></a><span class="w">        </span><span class="nt">entry</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;(FIXME|TODO|HACK|XXX):&#39;</span>
<a id="__codelineno-48-96" name="__codelineno-48-96" href="#__codelineno-48-96"></a><span class="w">        </span><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pygrep</span>
<a id="__codelineno-48-97" name="__codelineno-48-97" href="#__codelineno-48-97"></a><span class="w">        </span><span class="nt">types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">python</span><span class="p p-Indicator">]</span>
<a id="__codelineno-48-98" name="__codelineno-48-98" href="#__codelineno-48-98"></a><span class="w">        </span><span class="nt">pass_filenames</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-48-99" name="__codelineno-48-99" href="#__codelineno-48-99"></a>
<a id="__codelineno-48-100" name="__codelineno-48-100" href="#__codelineno-48-100"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest-check</span>
<a id="__codelineno-48-101" name="__codelineno-48-101" href="#__codelineno-48-101"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run fast unit tests</span>
<a id="__codelineno-48-102" name="__codelineno-48-102" href="#__codelineno-48-102"></a><span class="w">        </span><span class="nt">entry</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest</span>
<a id="__codelineno-48-103" name="__codelineno-48-103" href="#__codelineno-48-103"></a><span class="w">        </span><span class="nt">language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system</span>
<a id="__codelineno-48-104" name="__codelineno-48-104" href="#__codelineno-48-104"></a><span class="w">        </span><span class="nt">pass_filenames</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id="__codelineno-48-105" name="__codelineno-48-105" href="#__codelineno-48-105"></a><span class="w">        </span><span class="nt">always_run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-48-106" name="__codelineno-48-106" href="#__codelineno-48-106"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">tests/unit</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">-x</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--tb=short</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">--quiet</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>Setting up pre-commit is straightforward:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="c1"># Install pre-commit</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>pip<span class="w"> </span>install<span class="w"> </span>pre-commit
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="c1"># Install the git hooks</span>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>pre-commit<span class="w"> </span>install
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="c1"># Run against all files (useful for initial setup)</span>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>pre-commit<span class="w"> </span>run<span class="w"> </span>--all-files
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="c1"># Update hook versions</span>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>pre-commit<span class="w"> </span>autoupdate
</code></pre></div>
<p>Now every commit automatically:
- Formats code with Black
- Sorts imports with isort
- Fixes file issues (whitespace, line endings)
- Runs security scans
- Checks types
- Runs fast unit tests</p>
<p>If any check fails, the commit is blocked with clear feedback:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Add new feature&quot;</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>black....................................................................Passed
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>isort....................................................................Passed
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>ruff.....................................................................Failed
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>-<span class="w"> </span>hook<span class="w"> </span>id:<span class="w"> </span>ruff
<a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>-<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>code:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>
<a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>src/api/endpoints.py:45:80:<span class="w"> </span>E501<span class="w"> </span>Line<span class="w"> </span>too<span class="w"> </span>long<span class="w"> </span><span class="o">(</span><span class="m">92</span><span class="w"> </span>&gt;<span class="w"> </span><span class="m">88</span><span class="w"> </span>characters<span class="o">)</span>
<a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>
<a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>mypy.....................................................................Failed
<a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>-<span class="w"> </span>hook<span class="w"> </span>id:<span class="w"> </span>mypy
<a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>-<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>code:<span class="w"> </span><span class="m">1</span>
<a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a>
<a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a>src/services/order.py:23:<span class="w"> </span>error:<span class="w"> </span>Argument<span class="w"> </span><span class="m">1</span><span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;process&quot;</span><span class="w"> </span>has<span class="w"> </span>incompatible<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;str&quot;</span><span class="p">;</span><span class="w"> </span>expected<span class="w"> </span><span class="s2">&quot;UUID&quot;</span>
</code></pre></div>
<h3 id="ruff-the-fast-python-linter"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#ruff-the-fast-python-linter">Ruff: The Fast Python Linter</a></h3>
<p>Ruff has revolutionized Python linting by being 10-100x faster than traditional tools. The <a href="https://github.com/buildshift-dev/clean-py">clean-py repository</a> uses Ruff extensively:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1"># pyproject.toml</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="k">[tool.ruff]</span>
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="n">target-version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;py311&quot;</span>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="n">line-length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">88</span>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">    </span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># pycodestyle errors</span>
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="w">    </span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># pycodestyle warnings</span>
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="w">    </span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># pyflakes</span>
<a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="w">    </span><span class="s2">&quot;I&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># isort</span>
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="w">    </span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># flake8-bugbear</span>
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">    </span><span class="s2">&quot;C4&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1"># flake8-comprehensions</span>
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">    </span><span class="s2">&quot;UP&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1"># pyupgrade</span>
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="w">    </span><span class="s2">&quot;ARG&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1"># flake8-unused-arguments</span>
<a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="w">    </span><span class="s2">&quot;SIM&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1"># flake8-simplify</span>
<a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="w">    </span><span class="s2">&quot;TCH&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1"># flake8-type-checking</span>
<a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="w">    </span><span class="s2">&quot;DTZ&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1"># flake8-datetimez</span>
<a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a><span class="w">    </span><span class="s2">&quot;ERA&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1"># flake8-eradicate</span>
<a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="w">    </span><span class="s2">&quot;PTH&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1"># flake8-use-pathlib</span>
<a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="w">    </span><span class="s2">&quot;RUF&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1"># Ruff-specific rules</span>
<a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a><span class="p">]</span>
<a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a><span class="n">ignore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a><span class="w">    </span><span class="s2">&quot;E501&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># line too long (handled by black)</span>
<a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a><span class="w">    </span><span class="s2">&quot;B008&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># do not perform function calls in argument defaults</span>
<a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a><span class="w">    </span><span class="s2">&quot;C901&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># too complex</span>
<a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a><span class="w">    </span><span class="s2">&quot;W191&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1"># indentation contains tabs</span>
<a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a><span class="p">]</span>
<a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a>
<a id="__codelineno-51-28" name="__codelineno-51-28" href="#__codelineno-51-28"></a><span class="k">[tool.ruff.per-file-ignores]</span>
<a id="__codelineno-51-29" name="__codelineno-51-29" href="#__codelineno-51-29"></a><span class="s2">&quot;tests/*&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;S101&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ARG&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;PLR2004&quot;</span><span class="p">]</span><span class="w">  </span><span class="c1"># Allow assert, unused args, magic values in tests</span>
<a id="__codelineno-51-30" name="__codelineno-51-30" href="#__codelineno-51-30"></a><span class="s2">&quot;scripts/*&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;T201&quot;</span><span class="p">]</span><span class="w">  </span><span class="c1"># Allow print statements in scripts</span>
<a id="__codelineno-51-31" name="__codelineno-51-31" href="#__codelineno-51-31"></a>
<a id="__codelineno-51-32" name="__codelineno-51-32" href="#__codelineno-51-32"></a><span class="k">[tool.ruff.isort]</span>
<a id="__codelineno-51-33" name="__codelineno-51-33" href="#__codelineno-51-33"></a><span class="n">known-first-party</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;src&quot;</span><span class="p">]</span>
<a id="__codelineno-51-34" name="__codelineno-51-34" href="#__codelineno-51-34"></a>
<a id="__codelineno-51-35" name="__codelineno-51-35" href="#__codelineno-51-35"></a><span class="k">[tool.ruff.mccabe]</span>
<a id="__codelineno-51-36" name="__codelineno-51-36" href="#__codelineno-51-36"></a><span class="n">max-complexity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<a id="__codelineno-51-37" name="__codelineno-51-37" href="#__codelineno-51-37"></a>
<a id="__codelineno-51-38" name="__codelineno-51-38" href="#__codelineno-51-38"></a><span class="k">[tool.ruff.flake8-bugbear]</span>
<a id="__codelineno-51-39" name="__codelineno-51-39" href="#__codelineno-51-39"></a><span class="n">extend-immutable-calls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;fastapi.Depends&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;fastapi.Query&quot;</span><span class="p">]</span>
<a id="__codelineno-51-40" name="__codelineno-51-40" href="#__codelineno-51-40"></a>
<a id="__codelineno-51-41" name="__codelineno-51-41" href="#__codelineno-51-41"></a><span class="k">[tool.ruff.flake8-type-checking]</span>
<a id="__codelineno-51-42" name="__codelineno-51-42" href="#__codelineno-51-42"></a><span class="n">strict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</code></pre></div>
<p>Ruff catches real issues fast:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c1"># Before Ruff</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">process_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="p">[]):</span>  <span class="c1"># B006: mutable default</span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>  <span class="c1"># SIM108: Use &#39;if not items&#39;</span>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>
<a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
<a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>        <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">price</span>  <span class="c1"># SIM113: Use += operator</span>
<a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>
<a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>    <span class="c1"># Create datetime without timezone (DTZ001)</span>
<a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>    <span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a>
<a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a>    <span class="c1"># Using os.path instead of pathlib (PTH118)</span>
<a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a>    <span class="n">config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
<a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a>
<a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="c1"># After Ruff fixes</span>
<a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
<a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a>
<a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">process_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a>    <span class="k">if</span> <span class="n">items</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a>        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a>
<a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">items</span><span class="p">:</span>
<a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a>
<a id="__codelineno-52-28" name="__codelineno-52-28" href="#__codelineno-52-28"></a>    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">price</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">)</span>
<a id="__codelineno-52-29" name="__codelineno-52-29" href="#__codelineno-52-29"></a>
<a id="__codelineno-52-30" name="__codelineno-52-30" href="#__codelineno-52-30"></a>    <span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<a id="__codelineno-52-31" name="__codelineno-52-31" href="#__codelineno-52-31"></a>
<a id="__codelineno-52-32" name="__codelineno-52-32" href="#__codelineno-52-32"></a>    <span class="n">config_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;config.json&quot;</span>
</code></pre></div>
<h3 id="github-actions-cicd-pipeline"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#github-actions-cicd-pipeline">GitHub Actions: CI/CD Pipeline</a></h3>
<p>Pre-commit hooks are great, but they can be bypassed. CI/CD provides the final quality gate. Here's a comprehensive GitHub Actions workflow:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="c1"># .github/workflows/ci.yml</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CI Pipeline</span>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="nt">on</span><span class="p">:</span>
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">develop</span><span class="p p-Indicator">]</span>
<a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="w">  </span><span class="nt">schedule</span><span class="p">:</span>
<a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">cron</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0</span><span class="nv"> </span><span class="s">0</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">0&#39;</span><span class="w">  </span><span class="c1"># Weekly security scan</span>
<a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a>
<a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-53-13" name="__codelineno-53-13" href="#__codelineno-53-13"></a><span class="w">  </span><span class="nt">PYTHON_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.11&quot;</span>
<a id="__codelineno-53-14" name="__codelineno-53-14" href="#__codelineno-53-14"></a><span class="w">  </span><span class="nt">POETRY_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.6.1&quot;</span>
<a id="__codelineno-53-15" name="__codelineno-53-15" href="#__codelineno-53-15"></a>
<a id="__codelineno-53-16" name="__codelineno-53-16" href="#__codelineno-53-16"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-53-17" name="__codelineno-53-17" href="#__codelineno-53-17"></a><span class="w">  </span><span class="nt">quality</span><span class="p">:</span>
<a id="__codelineno-53-18" name="__codelineno-53-18" href="#__codelineno-53-18"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Code Quality Checks</span>
<a id="__codelineno-53-19" name="__codelineno-53-19" href="#__codelineno-53-19"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-53-20" name="__codelineno-53-20" href="#__codelineno-53-20"></a>
<a id="__codelineno-53-21" name="__codelineno-53-21" href="#__codelineno-53-21"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-53-22" name="__codelineno-53-22" href="#__codelineno-53-22"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<a id="__codelineno-53-23" name="__codelineno-53-23" href="#__codelineno-53-23"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-24" name="__codelineno-53-24" href="#__codelineno-53-24"></a><span class="w">          </span><span class="nt">fetch-depth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">  </span><span class="c1"># Full history for better analysis</span>
<a id="__codelineno-53-25" name="__codelineno-53-25" href="#__codelineno-53-25"></a>
<a id="__codelineno-53-26" name="__codelineno-53-26" href="#__codelineno-53-26"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<a id="__codelineno-53-27" name="__codelineno-53-27" href="#__codelineno-53-27"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v4</span>
<a id="__codelineno-53-28" name="__codelineno-53-28" href="#__codelineno-53-28"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-29" name="__codelineno-53-29" href="#__codelineno-53-29"></a><span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ env.PYTHON_VERSION }}</span>
<a id="__codelineno-53-30" name="__codelineno-53-30" href="#__codelineno-53-30"></a>
<a id="__codelineno-53-31" name="__codelineno-53-31" href="#__codelineno-53-31"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Cache dependencies</span>
<a id="__codelineno-53-32" name="__codelineno-53-32" href="#__codelineno-53-32"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/cache@v3</span>
<a id="__codelineno-53-33" name="__codelineno-53-33" href="#__codelineno-53-33"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-34" name="__codelineno-53-34" href="#__codelineno-53-34"></a><span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-35" name="__codelineno-53-35" href="#__codelineno-53-35"></a><span class="w">            </span><span class="no">~/.cache/pip</span>
<a id="__codelineno-53-36" name="__codelineno-53-36" href="#__codelineno-53-36"></a><span class="w">            </span><span class="no">~/.cache/pre-commit</span>
<a id="__codelineno-53-37" name="__codelineno-53-37" href="#__codelineno-53-37"></a><span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ runner.os }}-pip-${{ hashFiles(&#39;pyproject.toml&#39;) }}</span>
<a id="__codelineno-53-38" name="__codelineno-53-38" href="#__codelineno-53-38"></a><span class="w">          </span><span class="nt">restore-keys</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-39" name="__codelineno-53-39" href="#__codelineno-53-39"></a><span class="w">            </span><span class="no">${{ runner.os }}-pip-</span>
<a id="__codelineno-53-40" name="__codelineno-53-40" href="#__codelineno-53-40"></a>
<a id="__codelineno-53-41" name="__codelineno-53-41" href="#__codelineno-53-41"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<a id="__codelineno-53-42" name="__codelineno-53-42" href="#__codelineno-53-42"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-43" name="__codelineno-53-43" href="#__codelineno-53-43"></a><span class="w">          </span><span class="no">python -m pip install --upgrade pip</span>
<a id="__codelineno-53-44" name="__codelineno-53-44" href="#__codelineno-53-44"></a><span class="w">          </span><span class="no">pip install -e &quot;.[dev]&quot;</span>
<a id="__codelineno-53-45" name="__codelineno-53-45" href="#__codelineno-53-45"></a>
<a id="__codelineno-53-46" name="__codelineno-53-46" href="#__codelineno-53-46"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run pre-commit hooks</span>
<a id="__codelineno-53-47" name="__codelineno-53-47" href="#__codelineno-53-47"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pre-commit run --all-files --show-diff-on-failure</span>
<a id="__codelineno-53-48" name="__codelineno-53-48" href="#__codelineno-53-48"></a>
<a id="__codelineno-53-49" name="__codelineno-53-49" href="#__codelineno-53-49"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Black check</span>
<a id="__codelineno-53-50" name="__codelineno-53-50" href="#__codelineno-53-50"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">black --check src tests</span>
<a id="__codelineno-53-51" name="__codelineno-53-51" href="#__codelineno-53-51"></a>
<a id="__codelineno-53-52" name="__codelineno-53-52" href="#__codelineno-53-52"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Ruff linting</span>
<a id="__codelineno-53-53" name="__codelineno-53-53" href="#__codelineno-53-53"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ruff check src tests</span>
<a id="__codelineno-53-54" name="__codelineno-53-54" href="#__codelineno-53-54"></a>
<a id="__codelineno-53-55" name="__codelineno-53-55" href="#__codelineno-53-55"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run MyPy type checking</span>
<a id="__codelineno-53-56" name="__codelineno-53-56" href="#__codelineno-53-56"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mypy src --strict</span>
<a id="__codelineno-53-57" name="__codelineno-53-57" href="#__codelineno-53-57"></a>
<a id="__codelineno-53-58" name="__codelineno-53-58" href="#__codelineno-53-58"></a><span class="w">  </span><span class="nt">security</span><span class="p">:</span>
<a id="__codelineno-53-59" name="__codelineno-53-59" href="#__codelineno-53-59"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Security Scanning</span>
<a id="__codelineno-53-60" name="__codelineno-53-60" href="#__codelineno-53-60"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-53-61" name="__codelineno-53-61" href="#__codelineno-53-61"></a>
<a id="__codelineno-53-62" name="__codelineno-53-62" href="#__codelineno-53-62"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-53-63" name="__codelineno-53-63" href="#__codelineno-53-63"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<a id="__codelineno-53-64" name="__codelineno-53-64" href="#__codelineno-53-64"></a>
<a id="__codelineno-53-65" name="__codelineno-53-65" href="#__codelineno-53-65"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<a id="__codelineno-53-66" name="__codelineno-53-66" href="#__codelineno-53-66"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v4</span>
<a id="__codelineno-53-67" name="__codelineno-53-67" href="#__codelineno-53-67"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-68" name="__codelineno-53-68" href="#__codelineno-53-68"></a><span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ env.PYTHON_VERSION }}</span>
<a id="__codelineno-53-69" name="__codelineno-53-69" href="#__codelineno-53-69"></a>
<a id="__codelineno-53-70" name="__codelineno-53-70" href="#__codelineno-53-70"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<a id="__codelineno-53-71" name="__codelineno-53-71" href="#__codelineno-53-71"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-72" name="__codelineno-53-72" href="#__codelineno-53-72"></a><span class="w">          </span><span class="no">pip install -e &quot;.[dev]&quot;</span>
<a id="__codelineno-53-73" name="__codelineno-53-73" href="#__codelineno-53-73"></a><span class="w">          </span><span class="no">pip install bandit safety pip-audit</span>
<a id="__codelineno-53-74" name="__codelineno-53-74" href="#__codelineno-53-74"></a>
<a id="__codelineno-53-75" name="__codelineno-53-75" href="#__codelineno-53-75"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Bandit security linter</span>
<a id="__codelineno-53-76" name="__codelineno-53-76" href="#__codelineno-53-76"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit -r src -f json -o bandit-report.json</span>
<a id="__codelineno-53-77" name="__codelineno-53-77" href="#__codelineno-53-77"></a>
<a id="__codelineno-53-78" name="__codelineno-53-78" href="#__codelineno-53-78"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Bandit report</span>
<a id="__codelineno-53-79" name="__codelineno-53-79" href="#__codelineno-53-79"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v3</span>
<a id="__codelineno-53-80" name="__codelineno-53-80" href="#__codelineno-53-80"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-81" name="__codelineno-53-81" href="#__codelineno-53-81"></a><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit-report</span>
<a id="__codelineno-53-82" name="__codelineno-53-82" href="#__codelineno-53-82"></a><span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bandit-report.json</span>
<a id="__codelineno-53-83" name="__codelineno-53-83" href="#__codelineno-53-83"></a>
<a id="__codelineno-53-84" name="__codelineno-53-84" href="#__codelineno-53-84"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Safety check</span>
<a id="__codelineno-53-85" name="__codelineno-53-85" href="#__codelineno-53-85"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">safety check --json &gt; safety-report.json</span>
<a id="__codelineno-53-86" name="__codelineno-53-86" href="#__codelineno-53-86"></a><span class="w">        </span><span class="nt">continue-on-error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-53-87" name="__codelineno-53-87" href="#__codelineno-53-87"></a>
<a id="__codelineno-53-88" name="__codelineno-53-88" href="#__codelineno-53-88"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run pip-audit</span>
<a id="__codelineno-53-89" name="__codelineno-53-89" href="#__codelineno-53-89"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip-audit --desc</span>
<a id="__codelineno-53-90" name="__codelineno-53-90" href="#__codelineno-53-90"></a>
<a id="__codelineno-53-91" name="__codelineno-53-91" href="#__codelineno-53-91"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run Trivy vulnerability scanner</span>
<a id="__codelineno-53-92" name="__codelineno-53-92" href="#__codelineno-53-92"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasecurity/trivy-action@master</span>
<a id="__codelineno-53-93" name="__codelineno-53-93" href="#__codelineno-53-93"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-94" name="__codelineno-53-94" href="#__codelineno-53-94"></a><span class="w">          </span><span class="nt">scan-type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;fs&#39;</span>
<a id="__codelineno-53-95" name="__codelineno-53-95" href="#__codelineno-53-95"></a><span class="w">          </span><span class="nt">scan-ref</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;.&#39;</span>
<a id="__codelineno-53-96" name="__codelineno-53-96" href="#__codelineno-53-96"></a><span class="w">          </span><span class="nt">format</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;sarif&#39;</span>
<a id="__codelineno-53-97" name="__codelineno-53-97" href="#__codelineno-53-97"></a><span class="w">          </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;trivy-results.sarif&#39;</span>
<a id="__codelineno-53-98" name="__codelineno-53-98" href="#__codelineno-53-98"></a>
<a id="__codelineno-53-99" name="__codelineno-53-99" href="#__codelineno-53-99"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload Trivy results to GitHub Security</span>
<a id="__codelineno-53-100" name="__codelineno-53-100" href="#__codelineno-53-100"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github/codeql-action/upload-sarif@v2</span>
<a id="__codelineno-53-101" name="__codelineno-53-101" href="#__codelineno-53-101"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-102" name="__codelineno-53-102" href="#__codelineno-53-102"></a><span class="w">          </span><span class="nt">sarif_file</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;trivy-results.sarif&#39;</span>
<a id="__codelineno-53-103" name="__codelineno-53-103" href="#__codelineno-53-103"></a>
<a id="__codelineno-53-104" name="__codelineno-53-104" href="#__codelineno-53-104"></a><span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<a id="__codelineno-53-105" name="__codelineno-53-105" href="#__codelineno-53-105"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Test Suite</span>
<a id="__codelineno-53-106" name="__codelineno-53-106" href="#__codelineno-53-106"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-53-107" name="__codelineno-53-107" href="#__codelineno-53-107"></a><span class="w">    </span><span class="nt">strategy</span><span class="p">:</span>
<a id="__codelineno-53-108" name="__codelineno-53-108" href="#__codelineno-53-108"></a><span class="w">      </span><span class="nt">matrix</span><span class="p">:</span>
<a id="__codelineno-53-109" name="__codelineno-53-109" href="#__codelineno-53-109"></a><span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;3.11&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;3.12&quot;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-53-110" name="__codelineno-53-110" href="#__codelineno-53-110"></a>
<a id="__codelineno-53-111" name="__codelineno-53-111" href="#__codelineno-53-111"></a><span class="w">    </span><span class="nt">services</span><span class="p">:</span>
<a id="__codelineno-53-112" name="__codelineno-53-112" href="#__codelineno-53-112"></a><span class="w">      </span><span class="nt">postgres</span><span class="p">:</span>
<a id="__codelineno-53-113" name="__codelineno-53-113" href="#__codelineno-53-113"></a><span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres:15</span>
<a id="__codelineno-53-114" name="__codelineno-53-114" href="#__codelineno-53-114"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-53-115" name="__codelineno-53-115" href="#__codelineno-53-115"></a><span class="w">          </span><span class="nt">POSTGRES_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<a id="__codelineno-53-116" name="__codelineno-53-116" href="#__codelineno-53-116"></a><span class="w">          </span><span class="nt">POSTGRES_DB</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test_db</span>
<a id="__codelineno-53-117" name="__codelineno-53-117" href="#__codelineno-53-117"></a><span class="w">        </span><span class="nt">options</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<a id="__codelineno-53-118" name="__codelineno-53-118" href="#__codelineno-53-118"></a><span class="w">          </span><span class="no">--health-cmd pg_isready</span>
<a id="__codelineno-53-119" name="__codelineno-53-119" href="#__codelineno-53-119"></a><span class="w">          </span><span class="no">--health-interval 10s</span>
<a id="__codelineno-53-120" name="__codelineno-53-120" href="#__codelineno-53-120"></a><span class="w">          </span><span class="no">--health-timeout 5s</span>
<a id="__codelineno-53-121" name="__codelineno-53-121" href="#__codelineno-53-121"></a><span class="w">          </span><span class="no">--health-retries 5</span>
<a id="__codelineno-53-122" name="__codelineno-53-122" href="#__codelineno-53-122"></a><span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-53-123" name="__codelineno-53-123" href="#__codelineno-53-123"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5432:5432</span>
<a id="__codelineno-53-124" name="__codelineno-53-124" href="#__codelineno-53-124"></a>
<a id="__codelineno-53-125" name="__codelineno-53-125" href="#__codelineno-53-125"></a><span class="w">      </span><span class="nt">redis</span><span class="p">:</span>
<a id="__codelineno-53-126" name="__codelineno-53-126" href="#__codelineno-53-126"></a><span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7</span>
<a id="__codelineno-53-127" name="__codelineno-53-127" href="#__codelineno-53-127"></a><span class="w">        </span><span class="nt">options</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<a id="__codelineno-53-128" name="__codelineno-53-128" href="#__codelineno-53-128"></a><span class="w">          </span><span class="no">--health-cmd &quot;redis-cli ping&quot;</span>
<a id="__codelineno-53-129" name="__codelineno-53-129" href="#__codelineno-53-129"></a><span class="w">          </span><span class="no">--health-interval 10s</span>
<a id="__codelineno-53-130" name="__codelineno-53-130" href="#__codelineno-53-130"></a><span class="w">          </span><span class="no">--health-timeout 5s</span>
<a id="__codelineno-53-131" name="__codelineno-53-131" href="#__codelineno-53-131"></a><span class="w">          </span><span class="no">--health-retries 5</span>
<a id="__codelineno-53-132" name="__codelineno-53-132" href="#__codelineno-53-132"></a><span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-53-133" name="__codelineno-53-133" href="#__codelineno-53-133"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6379:6379</span>
<a id="__codelineno-53-134" name="__codelineno-53-134" href="#__codelineno-53-134"></a>
<a id="__codelineno-53-135" name="__codelineno-53-135" href="#__codelineno-53-135"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-53-136" name="__codelineno-53-136" href="#__codelineno-53-136"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<a id="__codelineno-53-137" name="__codelineno-53-137" href="#__codelineno-53-137"></a>
<a id="__codelineno-53-138" name="__codelineno-53-138" href="#__codelineno-53-138"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python ${{ matrix.python-version }}</span>
<a id="__codelineno-53-139" name="__codelineno-53-139" href="#__codelineno-53-139"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v4</span>
<a id="__codelineno-53-140" name="__codelineno-53-140" href="#__codelineno-53-140"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-141" name="__codelineno-53-141" href="#__codelineno-53-141"></a><span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.python-version }}</span>
<a id="__codelineno-53-142" name="__codelineno-53-142" href="#__codelineno-53-142"></a>
<a id="__codelineno-53-143" name="__codelineno-53-143" href="#__codelineno-53-143"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<a id="__codelineno-53-144" name="__codelineno-53-144" href="#__codelineno-53-144"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-145" name="__codelineno-53-145" href="#__codelineno-53-145"></a><span class="w">          </span><span class="no">pip install -e &quot;.[dev]&quot;</span>
<a id="__codelineno-53-146" name="__codelineno-53-146" href="#__codelineno-53-146"></a>
<a id="__codelineno-53-147" name="__codelineno-53-147" href="#__codelineno-53-147"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run unit tests</span>
<a id="__codelineno-53-148" name="__codelineno-53-148" href="#__codelineno-53-148"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-149" name="__codelineno-53-149" href="#__codelineno-53-149"></a><span class="w">          </span><span class="no">pytest tests/unit \</span>
<a id="__codelineno-53-150" name="__codelineno-53-150" href="#__codelineno-53-150"></a><span class="w">            </span><span class="no">--cov=src \</span>
<a id="__codelineno-53-151" name="__codelineno-53-151" href="#__codelineno-53-151"></a><span class="w">            </span><span class="no">--cov-report=xml \</span>
<a id="__codelineno-53-152" name="__codelineno-53-152" href="#__codelineno-53-152"></a><span class="w">            </span><span class="no">--cov-report=term-missing \</span>
<a id="__codelineno-53-153" name="__codelineno-53-153" href="#__codelineno-53-153"></a><span class="w">            </span><span class="no">--junit-xml=unit-test-results.xml</span>
<a id="__codelineno-53-154" name="__codelineno-53-154" href="#__codelineno-53-154"></a>
<a id="__codelineno-53-155" name="__codelineno-53-155" href="#__codelineno-53-155"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run integration tests</span>
<a id="__codelineno-53-156" name="__codelineno-53-156" href="#__codelineno-53-156"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-53-157" name="__codelineno-53-157" href="#__codelineno-53-157"></a><span class="w">          </span><span class="nt">DATABASE_URL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgresql://postgres:postgres@localhost:5432/test_db</span>
<a id="__codelineno-53-158" name="__codelineno-53-158" href="#__codelineno-53-158"></a><span class="w">          </span><span class="nt">REDIS_URL</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis://localhost:6379</span>
<a id="__codelineno-53-159" name="__codelineno-53-159" href="#__codelineno-53-159"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-160" name="__codelineno-53-160" href="#__codelineno-53-160"></a><span class="w">          </span><span class="no">pytest tests/integration \</span>
<a id="__codelineno-53-161" name="__codelineno-53-161" href="#__codelineno-53-161"></a><span class="w">            </span><span class="no">--junit-xml=integration-test-results.xml</span>
<a id="__codelineno-53-162" name="__codelineno-53-162" href="#__codelineno-53-162"></a>
<a id="__codelineno-53-163" name="__codelineno-53-163" href="#__codelineno-53-163"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload coverage to Codecov</span>
<a id="__codelineno-53-164" name="__codelineno-53-164" href="#__codelineno-53-164"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codecov/codecov-action@v3</span>
<a id="__codelineno-53-165" name="__codelineno-53-165" href="#__codelineno-53-165"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-166" name="__codelineno-53-166" href="#__codelineno-53-166"></a><span class="w">          </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./coverage.xml</span>
<a id="__codelineno-53-167" name="__codelineno-53-167" href="#__codelineno-53-167"></a><span class="w">          </span><span class="nt">fail_ci_if_error</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-53-168" name="__codelineno-53-168" href="#__codelineno-53-168"></a>
<a id="__codelineno-53-169" name="__codelineno-53-169" href="#__codelineno-53-169"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload test results</span>
<a id="__codelineno-53-170" name="__codelineno-53-170" href="#__codelineno-53-170"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/upload-artifact@v3</span>
<a id="__codelineno-53-171" name="__codelineno-53-171" href="#__codelineno-53-171"></a><span class="w">        </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always()</span>
<a id="__codelineno-53-172" name="__codelineno-53-172" href="#__codelineno-53-172"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-173" name="__codelineno-53-173" href="#__codelineno-53-173"></a><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-results-${{ matrix.python-version }}</span>
<a id="__codelineno-53-174" name="__codelineno-53-174" href="#__codelineno-53-174"></a><span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-175" name="__codelineno-53-175" href="#__codelineno-53-175"></a><span class="w">            </span><span class="no">unit-test-results.xml</span>
<a id="__codelineno-53-176" name="__codelineno-53-176" href="#__codelineno-53-176"></a><span class="w">            </span><span class="no">integration-test-results.xml</span>
<a id="__codelineno-53-177" name="__codelineno-53-177" href="#__codelineno-53-177"></a>
<a id="__codelineno-53-178" name="__codelineno-53-178" href="#__codelineno-53-178"></a><span class="w">  </span><span class="nt">build</span><span class="p">:</span>
<a id="__codelineno-53-179" name="__codelineno-53-179" href="#__codelineno-53-179"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build and Push Docker Image</span>
<a id="__codelineno-53-180" name="__codelineno-53-180" href="#__codelineno-53-180"></a><span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">quality</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">security</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">test</span><span class="p p-Indicator">]</span>
<a id="__codelineno-53-181" name="__codelineno-53-181" href="#__codelineno-53-181"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-53-182" name="__codelineno-53-182" href="#__codelineno-53-182"></a><span class="w">    </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">github.event_name == &#39;push&#39; &amp;&amp; github.ref == &#39;refs/heads/main&#39;</span>
<a id="__codelineno-53-183" name="__codelineno-53-183" href="#__codelineno-53-183"></a>
<a id="__codelineno-53-184" name="__codelineno-53-184" href="#__codelineno-53-184"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-53-185" name="__codelineno-53-185" href="#__codelineno-53-185"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
<a id="__codelineno-53-186" name="__codelineno-53-186" href="#__codelineno-53-186"></a>
<a id="__codelineno-53-187" name="__codelineno-53-187" href="#__codelineno-53-187"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Docker Buildx</span>
<a id="__codelineno-53-188" name="__codelineno-53-188" href="#__codelineno-53-188"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/setup-buildx-action@v3</span>
<a id="__codelineno-53-189" name="__codelineno-53-189" href="#__codelineno-53-189"></a>
<a id="__codelineno-53-190" name="__codelineno-53-190" href="#__codelineno-53-190"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Log in to Docker Hub</span>
<a id="__codelineno-53-191" name="__codelineno-53-191" href="#__codelineno-53-191"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/login-action@v3</span>
<a id="__codelineno-53-192" name="__codelineno-53-192" href="#__codelineno-53-192"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-193" name="__codelineno-53-193" href="#__codelineno-53-193"></a><span class="w">          </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.DOCKER_USERNAME }}</span>
<a id="__codelineno-53-194" name="__codelineno-53-194" href="#__codelineno-53-194"></a><span class="w">          </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.DOCKER_PASSWORD }}</span>
<a id="__codelineno-53-195" name="__codelineno-53-195" href="#__codelineno-53-195"></a>
<a id="__codelineno-53-196" name="__codelineno-53-196" href="#__codelineno-53-196"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Extract metadata</span>
<a id="__codelineno-53-197" name="__codelineno-53-197" href="#__codelineno-53-197"></a><span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">meta</span>
<a id="__codelineno-53-198" name="__codelineno-53-198" href="#__codelineno-53-198"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/metadata-action@v5</span>
<a id="__codelineno-53-199" name="__codelineno-53-199" href="#__codelineno-53-199"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-200" name="__codelineno-53-200" href="#__codelineno-53-200"></a><span class="w">          </span><span class="nt">images</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.DOCKER_USERNAME }}/clean-py</span>
<a id="__codelineno-53-201" name="__codelineno-53-201" href="#__codelineno-53-201"></a><span class="w">          </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-53-202" name="__codelineno-53-202" href="#__codelineno-53-202"></a><span class="w">            </span><span class="no">type=ref,event=branch</span>
<a id="__codelineno-53-203" name="__codelineno-53-203" href="#__codelineno-53-203"></a><span class="w">            </span><span class="no">type=ref,event=pr</span>
<a id="__codelineno-53-204" name="__codelineno-53-204" href="#__codelineno-53-204"></a><span class="w">            </span><span class="no">type=semver,pattern={{version}}</span>
<a id="__codelineno-53-205" name="__codelineno-53-205" href="#__codelineno-53-205"></a><span class="w">            </span><span class="no">type=semver,pattern={{major}}.{{minor}}</span>
<a id="__codelineno-53-206" name="__codelineno-53-206" href="#__codelineno-53-206"></a><span class="w">            </span><span class="no">type=sha</span>
<a id="__codelineno-53-207" name="__codelineno-53-207" href="#__codelineno-53-207"></a>
<a id="__codelineno-53-208" name="__codelineno-53-208" href="#__codelineno-53-208"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build and push Docker image</span>
<a id="__codelineno-53-209" name="__codelineno-53-209" href="#__codelineno-53-209"></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/build-push-action@v5</span>
<a id="__codelineno-53-210" name="__codelineno-53-210" href="#__codelineno-53-210"></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
<a id="__codelineno-53-211" name="__codelineno-53-211" href="#__codelineno-53-211"></a><span class="w">          </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.</span>
<a id="__codelineno-53-212" name="__codelineno-53-212" href="#__codelineno-53-212"></a><span class="w">          </span><span class="nt">push</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-53-213" name="__codelineno-53-213" href="#__codelineno-53-213"></a><span class="w">          </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ steps.meta.outputs.tags }}</span>
<a id="__codelineno-53-214" name="__codelineno-53-214" href="#__codelineno-53-214"></a><span class="w">          </span><span class="nt">labels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ steps.meta.outputs.labels }}</span>
<a id="__codelineno-53-215" name="__codelineno-53-215" href="#__codelineno-53-215"></a><span class="w">          </span><span class="nt">cache-from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type=gha</span>
<a id="__codelineno-53-216" name="__codelineno-53-216" href="#__codelineno-53-216"></a><span class="w">          </span><span class="nt">cache-to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type=gha,mode=max</span>
</code></pre></div>
<h3 id="make-unified-task-runner"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#make-unified-task-runner">Make: Unified Task Runner</a></h3>
<p>Make provides a consistent interface for all quality tasks:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="c"># Makefile</span>
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">quality</span>
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="nf">quality</span><span class="o">:</span><span class="w"> </span><span class="n">format</span> <span class="n">lint</span> <span class="n">type</span>-<span class="n">check</span> <span class="n">security</span> <span class="n">test</span> <span class="c">## Run all quality checks</span>
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>
<a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">format</span>
<a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="nf">format</span><span class="o">:</span><span class="w"> </span><span class="c">## Format code with black and isort</span>
<a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;🎨 Formatting code...&quot;</span>
<a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="w">    </span>black<span class="w"> </span>src<span class="w"> </span>tests
<a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="w">    </span>isort<span class="w"> </span>src<span class="w"> </span>tests
<a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="w">    </span>ruff<span class="w"> </span>check<span class="w"> </span>--fix<span class="w"> </span>src<span class="w"> </span>tests
<a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a>
<a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">lint</span>
<a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a><span class="nf">lint</span><span class="o">:</span><span class="w"> </span><span class="c">## Run linting checks</span>
<a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a><span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;🔍 Running linting checks...&quot;</span>
<a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a><span class="w">    </span>ruff<span class="w"> </span>check<span class="w"> </span>src<span class="w"> </span>tests
<a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a><span class="w">    </span>pylint<span class="w"> </span>src<span class="w"> </span>--rcfile<span class="o">=</span>.pylintrc
<a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a>
<a id="__codelineno-54-18" name="__codelineno-54-18" href="#__codelineno-54-18"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">type</span>-<span class="n">check</span>
<a id="__codelineno-54-19" name="__codelineno-54-19" href="#__codelineno-54-19"></a><span class="nf">type-check</span><span class="o">:</span><span class="w"> </span><span class="c">## Run type checking with mypy</span>
<a id="__codelineno-54-20" name="__codelineno-54-20" href="#__codelineno-54-20"></a><span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;📝 Running type checks...&quot;</span>
<a id="__codelineno-54-21" name="__codelineno-54-21" href="#__codelineno-54-21"></a><span class="w">    </span>mypy<span class="w"> </span>src<span class="w"> </span>--strict
<a id="__codelineno-54-22" name="__codelineno-54-22" href="#__codelineno-54-22"></a>
<a id="__codelineno-54-23" name="__codelineno-54-23" href="#__codelineno-54-23"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">security</span>
<a id="__codelineno-54-24" name="__codelineno-54-24" href="#__codelineno-54-24"></a><span class="nf">security</span><span class="o">:</span><span class="w"> </span><span class="c">## Run security checks</span>
<a id="__codelineno-54-25" name="__codelineno-54-25" href="#__codelineno-54-25"></a><span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;🔒 Running security checks...&quot;</span>
<a id="__codelineno-54-26" name="__codelineno-54-26" href="#__codelineno-54-26"></a><span class="w">    </span>bandit<span class="w"> </span>-r<span class="w"> </span>src<span class="w"> </span>-ll
<a id="__codelineno-54-27" name="__codelineno-54-27" href="#__codelineno-54-27"></a><span class="w">    </span>safety<span class="w"> </span>check
<a id="__codelineno-54-28" name="__codelineno-54-28" href="#__codelineno-54-28"></a><span class="w">    </span>pip-audit
<a id="__codelineno-54-29" name="__codelineno-54-29" href="#__codelineno-54-29"></a>
<a id="__codelineno-54-30" name="__codelineno-54-30" href="#__codelineno-54-30"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">test</span>
<a id="__codelineno-54-31" name="__codelineno-54-31" href="#__codelineno-54-31"></a><span class="nf">test</span><span class="o">:</span><span class="w"> </span><span class="c">## Run tests with coverage</span>
<a id="__codelineno-54-32" name="__codelineno-54-32" href="#__codelineno-54-32"></a><span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;🧪 Running tests...&quot;</span>
<a id="__codelineno-54-33" name="__codelineno-54-33" href="#__codelineno-54-33"></a><span class="w">    </span>pytest<span class="w"> </span>tests/unit<span class="w"> </span>--cov<span class="o">=</span>src<span class="w"> </span>--cov-report<span class="o">=</span>term-missing
<a id="__codelineno-54-34" name="__codelineno-54-34" href="#__codelineno-54-34"></a>
<a id="__codelineno-54-35" name="__codelineno-54-35" href="#__codelineno-54-35"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">test</span>-<span class="n">watch</span>
<a id="__codelineno-54-36" name="__codelineno-54-36" href="#__codelineno-54-36"></a><span class="nf">test-watch</span><span class="o">:</span><span class="w"> </span><span class="c">## Run tests in watch mode</span>
<a id="__codelineno-54-37" name="__codelineno-54-37" href="#__codelineno-54-37"></a><span class="w">    </span>ptw<span class="w"> </span>tests/unit<span class="w"> </span>--<span class="w"> </span>-x<span class="w"> </span>--tb<span class="o">=</span>short
<a id="__codelineno-54-38" name="__codelineno-54-38" href="#__codelineno-54-38"></a>
<a id="__codelineno-54-39" name="__codelineno-54-39" href="#__codelineno-54-39"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">ci</span>
<a id="__codelineno-54-40" name="__codelineno-54-40" href="#__codelineno-54-40"></a><span class="nf">ci</span><span class="o">:</span><span class="w"> </span><span class="c">## Run CI pipeline locally</span>
<a id="__codelineno-54-41" name="__codelineno-54-41" href="#__codelineno-54-41"></a><span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;🚀 Running CI pipeline...&quot;</span>
<a id="__codelineno-54-42" name="__codelineno-54-42" href="#__codelineno-54-42"></a><span class="w">    </span>pre-commit<span class="w"> </span>run<span class="w"> </span>--all-files
<a id="__codelineno-54-43" name="__codelineno-54-43" href="#__codelineno-54-43"></a><span class="w">    </span><span class="k">$(</span>MAKE<span class="k">)</span><span class="w"> </span>quality
<a id="__codelineno-54-44" name="__codelineno-54-44" href="#__codelineno-54-44"></a>
<a id="__codelineno-54-45" name="__codelineno-54-45" href="#__codelineno-54-45"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">update</span>-<span class="n">deps</span>
<a id="__codelineno-54-46" name="__codelineno-54-46" href="#__codelineno-54-46"></a><span class="nf">update-deps</span><span class="o">:</span><span class="w"> </span><span class="c">## Update dependencies</span>
<a id="__codelineno-54-47" name="__codelineno-54-47" href="#__codelineno-54-47"></a><span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;📦 Updating dependencies...&quot;</span>
<a id="__codelineno-54-48" name="__codelineno-54-48" href="#__codelineno-54-48"></a><span class="w">    </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip<span class="w"> </span>setuptools<span class="w"> </span>wheel
<a id="__codelineno-54-49" name="__codelineno-54-49" href="#__codelineno-54-49"></a><span class="w">    </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;.[dev]&quot;</span>
<a id="__codelineno-54-50" name="__codelineno-54-50" href="#__codelineno-54-50"></a><span class="w">    </span>pre-commit<span class="w"> </span>autoupdate
<a id="__codelineno-54-51" name="__codelineno-54-51" href="#__codelineno-54-51"></a><span class="w">    </span>safety<span class="w"> </span>check
<a id="__codelineno-54-52" name="__codelineno-54-52" href="#__codelineno-54-52"></a>
<a id="__codelineno-54-53" name="__codelineno-54-53" href="#__codelineno-54-53"></a><span class="nf">.PHONY</span><span class="o">:</span><span class="w"> </span><span class="n">clean</span>
<a id="__codelineno-54-54" name="__codelineno-54-54" href="#__codelineno-54-54"></a><span class="nf">clean</span><span class="o">:</span><span class="w"> </span><span class="c">## Clean temporary files</span>
<a id="__codelineno-54-55" name="__codelineno-54-55" href="#__codelineno-54-55"></a><span class="w">    </span>@echo<span class="w"> </span><span class="s2">&quot;🧹 Cleaning up...&quot;</span>
<a id="__codelineno-54-56" name="__codelineno-54-56" href="#__codelineno-54-56"></a><span class="w">    </span>find<span class="w"> </span>.<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;__pycache__&quot;</span><span class="w"> </span>-exec<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="o">{}</span><span class="w"> </span>+
<a id="__codelineno-54-57" name="__codelineno-54-57" href="#__codelineno-54-57"></a><span class="w">    </span>find<span class="w"> </span>.<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.pyc&quot;</span><span class="w"> </span>-delete
<a id="__codelineno-54-58" name="__codelineno-54-58" href="#__codelineno-54-58"></a><span class="w">    </span>rm<span class="w"> </span>-rf<span class="w"> </span>.pytest_cache<span class="w"> </span>.mypy_cache<span class="w"> </span>.ruff_cache
<a id="__codelineno-54-59" name="__codelineno-54-59" href="#__codelineno-54-59"></a><span class="w">    </span>rm<span class="w"> </span>-rf<span class="w"> </span>htmlcov<span class="w"> </span>.coverage<span class="w"> </span>coverage.xml
</code></pre></div>
<h3 id="advanced-quality-patterns"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#advanced-quality-patterns">Advanced Quality Patterns</a></h3>
<h4 id="1-complexity-analysis"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#1-complexity-analysis">1. Complexity Analysis</a></h4>
<p>Monitor code complexity to prevent unmaintainable code:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="c1"># .github/workflows/complexity.yml</span>
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">Run</span> <span class="n">complexity</span> <span class="n">analysis</span>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>  <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>    <span class="n">radon</span> <span class="n">cc</span> <span class="n">src</span> <span class="o">--</span><span class="nb">min</span> <span class="n">B</span> <span class="o">--</span><span class="n">show</span><span class="o">-</span><span class="n">complexity</span> <span class="o">--</span><span class="n">total</span><span class="o">-</span><span class="n">average</span>
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>    <span class="n">radon</span> <span class="n">mi</span> <span class="n">src</span> <span class="o">--</span><span class="nb">min</span> <span class="n">B</span> <span class="o">--</span><span class="n">show</span>
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>    <span class="n">xenon</span> <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">absolute</span> <span class="n">B</span> <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">modules</span> <span class="n">B</span> <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">average</span> <span class="n">A</span> <span class="n">src</span>
</code></pre></div>
<h4 id="2-documentation-coverage"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#2-documentation-coverage">2. Documentation Coverage</a></h4>
<p>Ensure code is properly documented:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="c1"># pyproject.toml</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="p">[</span><span class="n">tool</span><span class="o">.</span><span class="n">interrogate</span><span class="p">]</span>
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="n">ignore</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">method</span> <span class="o">=</span> <span class="n">true</span>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="n">ignore</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">module</span> <span class="o">=</span> <span class="n">false</span>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="n">ignore</span><span class="o">-</span><span class="n">magic</span> <span class="o">=</span> <span class="n">false</span>
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="n">ignore</span><span class="o">-</span><span class="n">semiprivate</span> <span class="o">=</span> <span class="n">false</span>
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="n">ignore</span><span class="o">-</span><span class="n">private</span> <span class="o">=</span> <span class="n">false</span>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="n">ignore</span><span class="o">-</span><span class="nb">property</span><span class="o">-</span><span class="n">decorators</span> <span class="o">=</span> <span class="n">false</span>
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="n">ignore</span><span class="o">-</span><span class="n">module</span> <span class="o">=</span> <span class="n">false</span>
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a><span class="n">fail</span><span class="o">-</span><span class="n">under</span> <span class="o">=</span> <span class="mi">80</span>
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="n">exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;setup.py&quot;</span><span class="p">,</span> <span class="s2">&quot;docs&quot;</span><span class="p">,</span> <span class="s2">&quot;build&quot;</span><span class="p">,</span> <span class="s2">&quot;tests&quot;</span><span class="p">]</span>
<a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a><span class="n">verbose</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a><span class="n">quiet</span> <span class="o">=</span> <span class="n">false</span>
<a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a><span class="n">whitelist</span><span class="o">-</span><span class="n">regex</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a><span class="n">color</span> <span class="o">=</span> <span class="n">true</span>
</code></pre></div>
<h4 id="3-dependency-license-checking"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#3-dependency-license-checking">3. Dependency License Checking</a></h4>
<p>Ensure dependencies have compatible licenses:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="c1"># .github/workflows/license-check.yml</span>
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Check dependency licenses</span>
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="w">    </span><span class="no">pip install pip-licenses</span>
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="w">    </span><span class="no">pip-licenses --with-license-file --format=json &gt; licenses.json</span>
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="w">    </span><span class="no">python scripts/check_licenses.py licenses.json</span>
</code></pre></div>
<h4 id="4-performance-regression-detection"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#4-performance-regression-detection">4. Performance Regression Detection</a></h4>
<p>Catch performance issues before production:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="c1"># tests/performance/test_benchmarks.py</span>
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pytest_benchmark.plugin</span><span class="w"> </span><span class="kn">import</span> <span class="n">benchmark</span>
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_order_processing_performance</span><span class="p">(</span><span class="n">benchmark</span><span class="p">):</span>
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">benchmark</span><span class="p">(</span><span class="n">process_large_order</span><span class="p">,</span> <span class="n">order_data</span><span class="p">)</span>
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>    <span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">total</span> <span class="o">&lt;</span> <span class="mi">1000</span>  <span class="c1"># Must process in under 1 second</span>
</code></pre></div>
<h3 id="quality-metrics-and-reporting"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#quality-metrics-and-reporting">Quality Metrics and Reporting</a></h3>
<p>Track quality metrics over time:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="c1"># scripts/quality_report.py</span>
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>
<a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_quality_report</span><span class="p">():</span>
<a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a>    <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a>        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
<a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a>        <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">{}</span>
<a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a>    <span class="p">}</span>
<a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a>
<a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a>    <span class="c1"># Code coverage</span>
<a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a>    <span class="n">coverage_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a>        <span class="p">[</span><span class="s2">&quot;coverage&quot;</span><span class="p">,</span> <span class="s2">&quot;report&quot;</span><span class="p">,</span> <span class="s2">&quot;--format=json&quot;</span><span class="p">],</span>
<a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a>        <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a>        <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a>    <span class="p">)</span>
<a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a>    <span class="n">report</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;coverage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">coverage_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a>
<a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a>    <span class="c1"># Complexity</span>
<a id="__codelineno-59-21" name="__codelineno-59-21" href="#__codelineno-59-21"></a>    <span class="n">radon_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-59-22" name="__codelineno-59-22" href="#__codelineno-59-22"></a>        <span class="p">[</span><span class="s2">&quot;radon&quot;</span><span class="p">,</span> <span class="s2">&quot;cc&quot;</span><span class="p">,</span> <span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;--json&quot;</span><span class="p">],</span>
<a id="__codelineno-59-23" name="__codelineno-59-23" href="#__codelineno-59-23"></a>        <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-59-24" name="__codelineno-59-24" href="#__codelineno-59-24"></a>        <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-59-25" name="__codelineno-59-25" href="#__codelineno-59-25"></a>    <span class="p">)</span>
<a id="__codelineno-59-26" name="__codelineno-59-26" href="#__codelineno-59-26"></a>    <span class="n">report</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;complexity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">radon_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<a id="__codelineno-59-27" name="__codelineno-59-27" href="#__codelineno-59-27"></a>
<a id="__codelineno-59-28" name="__codelineno-59-28" href="#__codelineno-59-28"></a>    <span class="c1"># Security issues</span>
<a id="__codelineno-59-29" name="__codelineno-59-29" href="#__codelineno-59-29"></a>    <span class="n">bandit_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-59-30" name="__codelineno-59-30" href="#__codelineno-59-30"></a>        <span class="p">[</span><span class="s2">&quot;bandit&quot;</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="s2">&quot;src&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;json&quot;</span><span class="p">],</span>
<a id="__codelineno-59-31" name="__codelineno-59-31" href="#__codelineno-59-31"></a>        <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-59-32" name="__codelineno-59-32" href="#__codelineno-59-32"></a>        <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-59-33" name="__codelineno-59-33" href="#__codelineno-59-33"></a>    <span class="p">)</span>
<a id="__codelineno-59-34" name="__codelineno-59-34" href="#__codelineno-59-34"></a>    <span class="n">report</span><span class="p">[</span><span class="s2">&quot;metrics&quot;</span><span class="p">][</span><span class="s2">&quot;security&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bandit_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<a id="__codelineno-59-35" name="__codelineno-59-35" href="#__codelineno-59-35"></a>
<a id="__codelineno-59-36" name="__codelineno-59-36" href="#__codelineno-59-36"></a>    <span class="c1"># Save report</span>
<a id="__codelineno-59-37" name="__codelineno-59-37" href="#__codelineno-59-37"></a>    <span class="n">reports_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;quality-reports&quot;</span><span class="p">)</span>
<a id="__codelineno-59-38" name="__codelineno-59-38" href="#__codelineno-59-38"></a>    <span class="n">reports_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-59-39" name="__codelineno-59-39" href="#__codelineno-59-39"></a>
<a id="__codelineno-59-40" name="__codelineno-59-40" href="#__codelineno-59-40"></a>    <span class="n">report_file</span> <span class="o">=</span> <span class="n">reports_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;report-</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">:</span><span class="s2">%Y%m%d-%H%M%S</span><span class="si">}</span><span class="s2">.json&quot;</span>
<a id="__codelineno-59-41" name="__codelineno-59-41" href="#__codelineno-59-41"></a>    <span class="n">report_file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-59-42" name="__codelineno-59-42" href="#__codelineno-59-42"></a>
<a id="__codelineno-59-43" name="__codelineno-59-43" href="#__codelineno-59-43"></a>    <span class="k">return</span> <span class="n">report</span>
<a id="__codelineno-59-44" name="__codelineno-59-44" href="#__codelineno-59-44"></a>
<a id="__codelineno-59-45" name="__codelineno-59-45" href="#__codelineno-59-45"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-59-46" name="__codelineno-59-46" href="#__codelineno-59-46"></a>    <span class="n">report</span> <span class="o">=</span> <span class="n">generate_quality_report</span><span class="p">()</span>
<a id="__codelineno-59-47" name="__codelineno-59-47" href="#__codelineno-59-47"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quality report generated: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-59-48" name="__codelineno-59-48" href="#__codelineno-59-48"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Coverage: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">][</span><span class="s1">&#39;coverage&#39;</span><span class="p">][</span><span class="s1">&#39;percent_covered&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="team-adoption-strategies"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#team-adoption-strategies">Team Adoption Strategies</a></h3>
<p>Getting a team to adopt quality automation requires more than just tools:</p>
<ol>
<li><strong>Start Small</strong>: Begin with formatting (Black) before adding complex checks</li>
<li><strong>Make It Fast</strong>: Keep pre-commit hooks under 10 seconds</li>
<li><strong>Provide Escape Hatches</strong>: Allow <code>--no-verify</code> for emergencies</li>
<li><strong>Document Everything</strong>: Create a quality guide with examples</li>
<li><strong>Celebrate Improvements</strong>: Share metrics showing reduced bugs</li>
<li><strong>Automate Fixes</strong>: Use <code>--fix</code> flags where possible</li>
<li><strong>Integrate with IDEs</strong>: Configure VS Code/PyCharm to run checks</li>
</ol>
<h3 id="conclusion"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#conclusion">Conclusion</a></h3>
<p>Quality automation isn't about perfection—it's about consistency and catching issues early. The <a href="https://github.com/buildshift-dev/clean-py">clean-py repository</a> shows how pre-commit hooks, CI/CD pipelines, and modern tools like Ruff create a safety net that lets developers move fast without breaking things.</p>
<p>The investment in setting up quality automation pays off immediately. Code reviews focus on logic instead of style. Bugs are caught before production. New team members follow standards automatically. The codebase remains maintainable as it grows.</p>
<p>In the next post, we'll explore production-ready logging, showing how to build observability into your Python applications from development to AWS CloudWatch. Quality code is just the beginning—you also need to know what it's doing in production.</p>
<p>Remember: Automation isn't about replacing human judgment. It's about freeing humans to focus on problems that actually require judgment.</p>
<h3 id="references"><a class="toclink" href="../../2025/06/30/code-quality-automation---pre-commit-hooks-and-cicd/#references">References</a></h3>
<ul>
<li><a href="https://github.com/buildshift-dev/clean-py">Clean-Py Repository</a> - Complete automation setup</li>
<li><a href="https://docs.astral.sh/ruff/">Ruff Documentation</a> - Fast Python linter</li>
<li><a href="https://pre-commit.com/hooks.html">Pre-commit Hooks</a> - Community hook collection</li>
<li><a href="https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-python">GitHub Actions Python</a> - CI/CD for Python</li>
</ul>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/buildshift-dev.png" alt="BuildShift Developer">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-06-18 19:30:00-04:00">Jun 18, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../infrastructure-as-code/" class="md-meta__link">Infrastructure as Code</a>, 
              <a href="../terraform/" class="md-meta__link">Terraform</a>, 
              <a href="./" class="md-meta__link">DevOps</a></li>
        
        
          
          <li class="md-meta__item">
            
              7 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="building-maintainable-infrastructure-how-to-organize-your-terraform-projects"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/">Building Maintainable Infrastructure: How to Organize Your Terraform Projects</a></h2>
<p>🔗 <strong>GitHub Repository</strong>: Find the complete sample project at <a href="https://github.com/buildshift-dev/tf-tutorial">tf-tutorial</a> 📁</p>
<p>When I first started working with Terraform, my configuration files were essentially one massive main.tf file that contained everything—resources, variables, outputs, all jumbled together. It worked, but as the infrastructure grew, making changes became increasingly risky. A simple update could have unintended consequences elsewhere, and collaborating with teammates was a constant source of merge conflicts.</p>
<p>After several painful refactoring sessions and learning from the community's collective wisdom, I've developed an appreciation for well-structured Terraform projects. Let me share what I've learned about organizing Terraform code in a way that scales with your team and infrastructure needs, using our sample-tf-project as a practical example.</p>
<h3 id="start-with-clear-directory-structure"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#start-with-clear-directory-structure">Start with Clear Directory Structure</a></h3>
<p>The foundation of any maintainable Terraform project is its directory structure. Think of it like organizing a kitchen—you wouldn't store your plates with your cleaning supplies. Similarly, different aspects of your infrastructure code deserve their own dedicated spaces.</p>
<p>Our sample-tf-project demonstrates this principle beautifully with its clear separation of concerns:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sample-tf-project/
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── infrastructure/
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>│   ├── environments/
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│   │   └── dev/
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│   │       ├── main.tf           # Environment-specific configuration
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>│   │       ├── variables.tf      # Environment variables
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>│   │       └── outputs.tf        # Environment outputs
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│   └── modules/
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>│       ├── lambda/
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>│       │   ├── main.tf           # Lambda module
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>│       │   ├── variables.tf      # Lambda variables
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>│       │   └── outputs.tf        # Lambda outputs
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>│       └── s3/
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>│           ├── main.tf           # S3 module
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>│           ├── variables.tf      # S3 variables
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>│           └── outputs.tf        # S3 outputs
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>├── src/
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>│   └── lambda/
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>│       ├── timestamp_function.py # Python Lambda function code
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>│       └── requirements.txt      # Python dependencies
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>└── scripts/
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    ├── deploy.sh                 # Deployment script
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    └── test-lambda.sh           # Testing script
</code></pre></div>
<p>This separation isn't just about being tidy. When your Lambda function code lives in a dedicated <code>src/lambda/</code> directory rather than being embedded in Terraform files, developers can work on application logic without navigating infrastructure complexity. The Python developers on your team can focus on <code>timestamp_function.py</code> without worrying about Terraform syntax. Similarly, having environment-specific directories like <code>environments/dev/</code> means you can safely experiment in development without accidentally affecting production configurations.</p>
<h3 id="embrace-modular-design"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#embrace-modular-design">Embrace Modular Design</a></h3>
<p>Creating reusable modules is where Terraform really shines. Instead of copying and pasting resource definitions across environments, modules let you define infrastructure patterns once and reuse them with different parameters. Think of modules as functions in programming—they accept inputs (variables), perform operations (create resources), and return outputs.</p>
<p>Look at how the sample-tf-project's main.tf file in the dev environment elegantly consumes modules:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># infrastructure/environments/dev/main.tf</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># Create S3 bucket module</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kr">module</span><span class="w"> </span><span class="nv">&quot;s3_bucket&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="na">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../../modules/s3&quot;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="na">bucket_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.bucket_name</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">  </span><span class="na">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.environment</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="p">}</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c1"># Create Lambda function module</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="kr">module</span><span class="w"> </span><span class="nv">&quot;lambda_function&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">  </span><span class="na">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../../modules/lambda&quot;</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">  </span><span class="na">function_name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nv">var.lambda_function_name</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">  </span><span class="na">bucket_name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="nv">module.s3_bucket.bucket_name</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">  </span><span class="na">bucket_arn</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="nv">module.s3_bucket.bucket_arn</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">  </span><span class="na">environment</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="nv">var.environment</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">  </span><span class="na">lambda_source_path</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">var.lambda_source_path</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">  </span><span class="na">lambda_role_name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">var.lambda_role_name</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="p">}</span>
</code></pre></div>
<p>Notice how clean this is? The environment configuration doesn't worry about S3 encryption settings or Lambda runtime configurations. Those details are abstracted into the modules. The S3 module in our project encapsulates security best practices automatically:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># infrastructure/modules/s3/main.tf</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_s3_bucket&quot;</span><span class="w"> </span><span class="nv">&quot;timestamp_bucket&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${var.bucket_name}-${var.environment}&quot;</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">}</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1"># Block public access to the S3 bucket</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_s3_bucket_public_access_block&quot;</span><span class="w"> </span><span class="nv">&quot;timestamp_bucket_pab&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">  </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_s3_bucket.timestamp_bucket.id</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">  </span><span class="na">block_public_acls</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">  </span><span class="na">block_public_policy</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">  </span><span class="na">ignore_public_acls</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">  </span><span class="na">restrict_public_buckets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="p">}</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="c1"># Add server-side encryption</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_s3_bucket_server_side_encryption_configuration&quot;</span><span class="w"> </span><span class="nv">&quot;timestamp_bucket_encryption&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="w">  </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_s3_bucket.timestamp_bucket.id</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="w">  </span><span class="nb">rule</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="w">    </span><span class="nb">apply_server_side_encryption_by_default</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="w">      </span><span class="na">sse_algorithm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;AES256&quot;</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="p">}</span>
</code></pre></div>
<p>Your S3 module becomes a contract that ensures every S3 bucket in your infrastructure follows the same security and operational standards. When AWS releases new features or your security team updates requirements, you update the module once, and all environments benefit.</p>
<p>The Lambda module similarly encapsulates complexity while exposing just the right parameters:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># infrastructure/modules/lambda/main.tf</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_lambda_function&quot;</span><span class="w"> </span><span class="nv">&quot;timestamp_lambda&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="na">filename</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">data.archive_file.lambda_zip.output_path</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span><span class="na">function_name</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${var.function_name}-${var.environment}&quot;</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span><span class="na">role</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_iam_role.lambda_role.arn</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="na">handler</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;timestamp_function.lambda_handler&quot;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="na">source_code_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.archive_file.lambda_zip.output_base64sha256</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">  </span><span class="na">runtime</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">var.runtime</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">  </span><span class="na">timeout</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">var.timeout</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">  </span><span class="nb">environment</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">    </span><span class="nb">variables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">      </span><span class="na">BUCKET_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.bucket_name</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">      </span><span class="na">ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.environment</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="p">}</span>
</code></pre></div>
<p>The key is finding the right level of abstraction. Our modules are focused enough to be understandable but flexible enough to handle variations between use cases. The Lambda module accepts parameters for function name and timeout, but it enforces naming conventions (appending the environment) and standard configurations.</p>
<h3 id="environment-management-done-right"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#environment-management-done-right">Environment Management Done Right</a></h3>
<p>Each environment should be self-contained with its own state file and variable definitions. This isolation is crucial for safety and sanity. When you run terraform apply in your development environment, you want absolute confidence that production remains untouched.</p>
<p>The sample-tf-project demonstrates this with its environment structure. Each environment gets its own directory under <code>infrastructure/environments/</code>, and you can customize behavior through terraform.tfvars files:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># infrastructure/environments/dev/terraform.tfvars</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="na">aws_region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;us-west-2&quot;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="na">bucket_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my-unique-timestamp-bucket&quot;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="na">lambda_function_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;timestamp-creator&quot;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="na">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;dev&quot;</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="na">lambda_role_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;TerraformLambdaRole&quot;</span>
</code></pre></div>
<p>This approach makes it obvious what differs between environments and prevents accidental production changes. To extend this to multiple environments, you simply copy the dev directory structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Create staging and production environments</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>cp<span class="w"> </span>-r<span class="w"> </span>infrastructure/environments/dev<span class="w"> </span>infrastructure/environments/staging
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>cp<span class="w"> </span>-r<span class="w"> </span>infrastructure/environments/dev<span class="w"> </span>infrastructure/environments/prod
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1"># Then customize each environment&#39;s terraform.tfvars</span>
</code></pre></div>
<p>The beauty is that each environment maintains its own Terraform state, completely isolated from others. A junior developer experimenting in dev can't accidentally destroy production resources.</p>
<h3 id="automate-with-purpose"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#automate-with-purpose">Automate with Purpose</a></h3>
<p>Scripts aren't just conveniences; they're documentation of your processes. The sample-tf-project includes thoughtfully designed automation scripts that make deployment straightforward:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># scripts/deploy.sh usage</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>./scripts/deploy.sh<span class="w"> </span>dev<span class="w"> </span>init<span class="w">     </span><span class="c1"># Initialize Terraform</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>./scripts/deploy.sh<span class="w"> </span>dev<span class="w"> </span>plan<span class="w">     </span><span class="c1"># Plan changes</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>./scripts/deploy.sh<span class="w"> </span>dev<span class="w"> </span>apply<span class="w">    </span><span class="c1"># Apply changes</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>./scripts/deploy.sh<span class="w"> </span>dev<span class="w"> </span>destroy<span class="w">  </span><span class="c1"># Tear down resources</span>
</code></pre></div>
<p>Look at how the deploy script handles environment management:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c1"># Simplified excerpt from scripts/deploy.sh</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="nv">ENVIRONMENT</span><span class="o">=</span><span class="nv">$1</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="nv">COMMAND</span><span class="o">=</span><span class="nv">$2</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="c1"># Navigate to the correct environment directory</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;infrastructure/environments/</span><span class="si">${</span><span class="nv">ENVIRONMENT</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="c1"># Execute the Terraform command</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="k">case</span><span class="w"> </span><span class="nv">$COMMAND</span><span class="w"> </span><span class="k">in</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span>init<span class="o">)</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">    </span>terraform<span class="w"> </span>init
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">    </span><span class="p">;;</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">  </span>plan<span class="o">)</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">    </span>terraform<span class="w"> </span>plan
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">    </span><span class="p">;;</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">  </span>apply<span class="o">)</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">    </span>terraform<span class="w"> </span>apply
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">    </span><span class="p">;;</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">  </span><span class="c1"># ... other commands</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="k">esac</span>
</code></pre></div>
<p>These scripts handle the navigation between directories, ensure the correct environment is targeted, and provide a consistent interface regardless of which environment you're deploying. The test script goes even further, automating Lambda invocation and S3 verification:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># scripts/test-lambda.sh automates testing</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>./scripts/test-lambda.sh<span class="w"> </span>dev
</code></pre></div>
<p>This investment in automation pays dividends when onboarding new developers or during incident response when every second counts.</p>
<h3 id="security-as-a-foundation"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#security-as-a-foundation">Security as a Foundation</a></h3>
<p>Security shouldn't be an afterthought bolted onto your infrastructure. The sample-tf-project demonstrates this principle by building security into the module designs. Look at how the S3 module automatically implements multiple layers of security:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Versioning for data protection</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_s3_bucket_versioning&quot;</span><span class="w"> </span><span class="nv">&quot;timestamp_bucket_versioning&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_s3_bucket.timestamp_bucket.id</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="nb">versioning_configuration</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Enabled&quot;</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="p">}</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c1"># Lifecycle rules for cost optimization and compliance</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_s3_bucket_lifecycle_configuration&quot;</span><span class="w"> </span><span class="nv">&quot;timestamp_bucket_lifecycle&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">  </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_s3_bucket.timestamp_bucket.id</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">  </span><span class="nb">rule</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="na">id</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;timestamp_files_lifecycle&quot;</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">    </span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Enabled&quot;</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">    </span><span class="nb">expiration</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">      </span><span class="na">days</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.file_retention_days</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">    </span><span class="nb">noncurrent_version_expiration</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">      </span><span class="na">noncurrent_days</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="p">}</span>
</code></pre></div>
<p>When security is built into the foundation, developers don't need to be security experts to deploy secure infrastructure. Every S3 bucket created through this module automatically gets encryption, public access blocking, versioning, and lifecycle policies.</p>
<p>The project also demonstrates the principle of least privilege with IAM roles. Rather than embedding AWS credentials or creating overly permissive policies, it references a pre-created role with specific permissions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Reference the manually created IAM role</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="kr">data</span><span class="w"> </span><span class="nc">&quot;aws_iam_role&quot;</span><span class="w"> </span><span class="nv">&quot;lambda_role&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.lambda_role_name</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="p">}</span>
</code></pre></div>
<p>This approach extends beyond individual resources. The modules interact securely, with the Lambda module receiving the S3 bucket ARN from the S3 module output, ensuring proper resource dependencies and access patterns.</p>
<h3 id="real-world-application"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#real-world-application">Real-World Application</a></h3>
<p>The sample-tf-project isn't just a toy example—it demonstrates patterns that scale to production workloads. The project creates a Lambda function that generates timestamp files and stores them in S3, but the patterns it establishes work for any AWS infrastructure:</p>
<ul>
<li><strong>Modular design</strong> that promotes reuse across projects</li>
<li><strong>Environment isolation</strong> that prevents costly mistakes</li>
<li><strong>Automated deployment</strong> that reduces human error</li>
<li><strong>Built-in security</strong> that meets compliance requirements</li>
<li><strong>Clear documentation</strong> that onboards new team members quickly</li>
</ul>
<p>🔗 <strong>GitHub Repository</strong>: You can find the complete implementation at [YOUR_GITHUB_REPO_URL_HERE] 📁</p>
<p>The repository includes additional features like CloudFormation templates for IAM role creation, comprehensive testing scripts, and detailed documentation for getting started.</p>
<h3 id="extending-the-structure"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#extending-the-structure">Extending the Structure</a></h3>
<p>Once you've mastered the basic structure demonstrated in sample-tf-project, you can extend it for more complex scenarios:</p>
<h4 id="remote-state-management"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#remote-state-management">Remote State Management</a></h4>
<p>Add backend configuration for storing Terraform state in S3:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># infrastructure/environments/dev/backend.tf</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="nb">terraform</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="kr">backend</span><span class="w"> </span><span class="nv">&quot;s3&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;terraform-state-bucket&quot;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="na">key</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;dev/terraform.tfstate&quot;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;us-west-2&quot;</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="p">}</span>
</code></pre></div>
<h4 id="multi-region-deployments"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#multi-region-deployments">Multi-Region Deployments</a></h4>
<p>Extend the module structure to support regional variations:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>infrastructure/
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>├── environments/
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>│   └── dev/
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>│       ├── us-west-2/
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>│       └── eu-west-1/
</code></pre></div>
<h4 id="shared-resources"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#shared-resources">Shared Resources</a></h4>
<p>Add a global directory for resources that span environments:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>infrastructure/
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>├── global/
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>│   ├── iam/
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>│   └── route53/
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>├── environments/
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>└── modules/
</code></pre></div>
<h3 id="looking-forward"><a class="toclink" href="../../2025/06/18/building-maintainable-infrastructure---how-to-organize-your-terraform-projects/#looking-forward">Looking Forward</a></h3>
<p>The sample-tf-project provides a solid foundation for organizing Terraform projects, but remember that the best structure is one that evolves with your needs. Start with the patterns demonstrated in the project:</p>
<ol>
<li><strong>Separate infrastructure, modules, and application code</strong></li>
<li><strong>Create reusable modules with sensible defaults</strong></li>
<li><strong>Isolate environments completely</strong></li>
<li><strong>Automate common workflows</strong></li>
<li><strong>Build security into every component</strong></li>
</ol>
<p>As your infrastructure grows, you'll discover new patterns and optimizations. Perhaps you'll add a module registry, implement policy as code with Sentinel or Open Policy Agent, or integrate with a CI/CD pipeline for automated deployments.</p>
<p>The key is to start with a solid foundation like the one demonstrated in sample-tf-project, then iterate based on your team's needs. Every improvement you make compounds over time, turning infrastructure management from a source of stress into a well-oiled machine.</p>
<p>Remember, organizing Terraform projects well isn't about following rules blindly—it's about creating a structure that makes your team more productive, your infrastructure more reliable, and your applications more secure. The sample-tf-project shows you how to achieve all three goals with a clean, maintainable structure that scales from proof-of-concept to production.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://github.com/buildshift-dev.png" alt="BuildShift Developer">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2025-05-29 20:45:00-04:00">May 29, 2025</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../infrastructure-as-code/" class="md-meta__link">Infrastructure as Code</a>, 
              <a href="../terraform/" class="md-meta__link">Terraform</a>, 
              <a href="./" class="md-meta__link">DevOps</a></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="dont-let-your-terraform-state-file-ruin-your-day-a-hard-learned-lesson"><a class="toclink" href="../../2025/05/29/dont-let-your-terraform-state-file-ruin-your-day---a-hard-learned-lesson/">Don't Let Your Terraform State File Ruin Your Day: A Hard-Learned Lesson</a></h2>
<p>🔗 <strong>GitHub Repository</strong>: Find the complete sample project at <a href="https://github.com/buildshift-dev/tf-tutorial">tf-tutorial</a> 📁</p>
<p>If you've been working with Terraform for any length of time, you've probably experienced that sinking feeling when your state file gets corrupted. I know I have—multiple times, actually. There's nothing quite like running <code>terraform plan</code> and seeing it want to recreate your entire production infrastructure because the state file is out of sync. Trust me, you don't want to be that person explaining to your team why all the servers just disappeared.</p>
<h3 id="the-state-file-your-infrastructures-memory"><a class="toclink" href="../../2025/05/29/dont-let-your-terraform-state-file-ruin-your-day---a-hard-learned-lesson/#the-state-file-your-infrastructures-memory">The State File: Your Infrastructure's Memory</a></h3>
<p>Terraform's state file is essentially your infrastructure's memory. It tracks what resources exist, their current configuration, and how they map to your configuration files. When this file gets corrupted, lost, or out of sync, Terraform loses its ability to manage your infrastructure properly. The result? Chaos.</p>
<p>During my early days learning Terraform, state file corruption got me more times than I care to admit. I'd make a simple change, run <code>terraform apply</code>, and suddenly Terraform would think resources that had been running for weeks didn't exist. Sometimes I'd end up with duplicate resources, orphaned infrastructure, or worse—completely broken deployments that required manual cleanup.</p>
<h3 id="why-cdk-and-cloudformation-might-be-better-for-learning"><a class="toclink" href="../../2025/05/29/dont-let-your-terraform-state-file-ruin-your-day---a-hard-learned-lesson/#why-cdk-and-cloudformation-might-be-better-for-learning">Why CDK and CloudFormation Might Be Better for Learning</a></h3>
<p>For beginners or quick experiments, AWS CDK and CloudFormation actually offer some significant advantages over Terraform:</p>
<ul>
<li><strong>Built-in state management</strong>: CloudFormation handles state automatically through AWS APIs</li>
<li><strong>Easy cleanup</strong>: Deleting a CloudFormation stack removes all associated resources</li>
<li><strong>Rollback capabilities</strong>: Failed deployments automatically roll back to the previous state</li>
<li><strong>Integrated monitoring</strong>: Native AWS integration provides better visibility into deployment status</li>
</ul>
<p>These tools eliminate the state management complexity that trips up many Terraform newcomers. You can focus on learning infrastructure concepts without worrying about state file corruption.</p>
<h3 id="why-terraform-still-rules-for-enterprise"><a class="toclink" href="../../2025/05/29/dont-let-your-terraform-state-file-ruin-your-day---a-hard-learned-lesson/#why-terraform-still-rules-for-enterprise">Why Terraform Still Rules for Enterprise</a></h3>
<p>Despite the learning curve, Terraform remains the gold standard for enterprise infrastructure management:</p>
<ul>
<li><strong>Multi-cloud support</strong>: Manage AWS, Azure, GCP, and other providers with one tool</li>
<li><strong>Rich ecosystem</strong>: Extensive provider library covering virtually every service</li>
<li><strong>Mature tooling</strong>: Better testing, validation, and CI/CD integration</li>
<li><strong>Modularity</strong>: Create reusable, shareable infrastructure components</li>
<li><strong>State management flexibility</strong>: Once mastered, provides powerful deployment strategies</li>
</ul>
<h3 id="getting-state-management-right-the-sample-tf-state-lock-project"><a class="toclink" href="../../2025/05/29/dont-let-your-terraform-state-file-ruin-your-day---a-hard-learned-lesson/#getting-state-management-right-the-sample-tf-state-lock-project">Getting State Management Right: The <code>sample-tf-state-lock</code> Project</a></h3>
<p>The key to avoiding state file disasters is implementing proper remote state management with locking from day one. While there are many approaches to Terraform state management—including enterprise solutions like Terraform Cloud, Terraform Enterprise, Azure DevOps, GitLab CI/CD with remote backends, and HashiCorp Consul—the S3-DynamoDB combination remains one of the most accessible options for learning and experimentation.</p>
<p>This approach is particularly well-suited for Cloud Guru environments and provides a solid foundation for understanding state management concepts without requiring enterprise tooling or complex setup. Our <code>sample-tf-state-lock</code> project demonstrates this with a clean, production-ready structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sample-tf-state-lock/
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── infrastructure/
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>│   ├── environments/
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│   │   └── dev/
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│   │       ├── main.tf           # S3 backend configuration
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>│   │       ├── variables.tf      
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>│   │       └── outputs.tf        
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│   └── modules/
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>│       ├── lambda/
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>│       └── s3/
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>├── src/
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>│   └── lambda/
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>└── scripts/
</code></pre></div>
<p>The magic happens in the backend configuration in <code>infrastructure/environments/dev/main.tf</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kr">backend</span><span class="w"> </span><span class="nv">&quot;s3&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="na">bucket</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;cloudguru-terraform-state-767398100921&quot;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="na">key</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;sample-tf-state-lock/dev/terraform.tfstate&quot;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="na">encrypt</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="no">false</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="na">dynamodb_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;cloudguru-terraform-state-767398100921-lock&quot;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="na">region</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;us-east-1&quot;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="p">}</span>
</code></pre></div>
<p>This setup provides:</p>
<ol>
<li><strong>Remote storage</strong>: State files stored in S3, not locally</li>
<li><strong>State locking</strong>: DynamoDB prevents concurrent modifications</li>
<li><strong>Environment isolation</strong>: Separate state files for dev/staging/prod</li>
<li><strong>Team collaboration</strong>: Multiple developers can work safely</li>
</ol>
<h3 id="the-three-pillars-of-state-management"><a class="toclink" href="../../2025/05/29/dont-let-your-terraform-state-file-ruin-your-day---a-hard-learned-lesson/#the-three-pillars-of-state-management">The Three Pillars of State Management</a></h3>
<p>Based on painful experience, here are the non-negotiables for Terraform state management:</p>
<p><strong>1. Remote State Storage</strong>: Never store state files locally or in version control. Use S3, Azure Storage, or similar cloud storage with versioning enabled.</p>
<p><strong>2. State Locking</strong>: Always configure state locking (DynamoDB for S3 backend) to prevent multiple users from modifying infrastructure simultaneously.</p>
<p><strong>3. Environment Separation</strong>: Use separate state files for different environments. The last thing you want is a dev deployment accidentally affecting production.</p>
<p>The <code>sample-tf-state-lock</code> project implements all three pillars, creating a foundation that scales from small experiments to enterprise deployments.</p>
<h3 id="making-it-foolproof"><a class="toclink" href="../../2025/05/29/dont-let-your-terraform-state-file-ruin-your-day---a-hard-learned-lesson/#making-it-foolproof">Making It Foolproof</a></h3>
<p>The project includes deployment scripts that make state management transparent:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>./scripts/deploy.sh<span class="w"> </span>dev<span class="w"> </span>init
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>./scripts/deploy.sh<span class="w"> </span>dev<span class="w"> </span>apply
</code></pre></div>
<p>These scripts handle the complexity while ensuring proper state management practices. The modular structure means you can extend the pattern to new environments and projects without reinventing the wheel.</p>
<h3 id="dont-learn-the-hard-way"><a class="toclink" href="../../2025/05/29/dont-let-your-terraform-state-file-ruin-your-day---a-hard-learned-lesson/#dont-learn-the-hard-way">Don't Learn the Hard Way</a></h3>
<p>State file corruption will teach you about Terraform state management, but it's a lesson you'd rather avoid. By starting with proper remote state configuration and locking, you can focus on building infrastructure instead of recovering from disasters.</p>
<p>🔗 <strong>GitHub Repository</strong>: The complete example is available at <a href="https://github.com/buildshift-dev/tf-tutorial">tf-tutorial</a> 📁</p>
<p>Use it as a foundation for your own projects, and save yourself the headaches I experienced learning Terraform the hard way.</p>
<p>Remember: your future self will thank you for setting up proper state management from the beginning. Trust me on this one.</p>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 buildshift.dev
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/buildshift-dev" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/your-profile" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/your-handle" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:contact@buildshift.dev" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l208 156a48 48 0 0 0 57.6 0l208-156c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48zM0 196v188c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V196L313.6 344.8c-34.1 25.6-81.1 25.6-115.2 0z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.path", "navigation.top", "search.highlight", "search.share", "search.suggest", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../assets/js/buildshift.js"></script>
      
    
  </body>
</html>